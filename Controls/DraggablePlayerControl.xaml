<UserControl
    x:Class="ModernIPTVPlayer.Controls.DraggablePlayerControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:ModernIPTVPlayer.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400">

    <UserControl.Resources>
        <Storyboard x:Name="ShowOverlayAnim">
            <DoubleAnimation Storyboard.TargetName="OverlayGrid" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.2" />
        </Storyboard>
        <Storyboard x:Name="HideOverlayAnim">
            <DoubleAnimation Storyboard.TargetName="OverlayGrid" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.2" />
        </Storyboard>
    </UserControl.Resources>

    <Grid x:Name="MainRoot" Background="Black" CornerRadius="0" BorderThickness="0"
          PointerEntered="Root_PointerEntered" PointerExited="Root_PointerExited">
        <!-- PLAYER HOST -->
        <Grid x:Name="PlayerHost">
            <!-- MPV will be injected here programmatically to avoid XAML init issues -->
        </Grid>

        <!-- OVERLAY (Visible on Hover) -->
        <Grid x:Name="OverlayGrid" Opacity="0" Background="#66000000">
            
            <!-- HEADER (Dragger) -->
            <Grid x:Name="ControlHeader" Height="48" VerticalAlignment="Top" 
                  ManipulationMode="TranslateX,TranslateY" 
                  ManipulationDelta="Header_ManipulationDelta"
                  ManipulationCompleted="Header_ManipulationCompleted"
                  PointerPressed="Header_PointerPressed">
                <Grid.Background>
                     <LinearGradientBrush x:Name="HeaderGradient" StartPoint="0,0" EndPoint="0,1">
                          <GradientStop Color="#CC000000" Offset="0.0"/>
                          <GradientStop Color="#66000000" Offset="0.8"/>
                          <GradientStop Color="Transparent" Offset="1.0"/>
                     </LinearGradientBrush>
                </Grid.Background>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition x:Name="HeaderCol0" Width="*" />
                    <ColumnDefinition x:Name="HeaderCol1" Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="TitleText" Grid.Column="0" Text="Loading..." VerticalAlignment="Center" Margin="15,0" Foreground="White" FontSize="14" TextTrimming="CharacterEllipsis"/>

                <StackPanel x:Name="ControlButtons" Grid.Column="1" Orientation="Horizontal" Spacing="5" Margin="0,0,10,0">
                    <!-- Mute Toggle -->
                    <Button x:Name="MuteBtn" Background="Transparent" BorderThickness="0" Click="MuteButton_Click" ToolTipService.ToolTip="Sesi Kapat/AÃ§">
                        <FontIcon x:Name="MuteIcon" Glyph="&#xE767;" FontSize="16" Foreground="White"/>
                    </Button>

                    <!-- Fullscreen Toggle (Player specific) -->
                    <Button x:Name="FullscreenBtn" Background="Transparent" BorderThickness="0" Click="FullscreenButton_Click" ToolTipService.ToolTip="Tam Ekran">
                        <FontIcon Glyph="&#xE740;" FontSize="16" Foreground="White"/>
                    </Button>

                    <!-- Close Button -->
                    <Button Background="Transparent" BorderThickness="0" Click="CloseButton_Click" ToolTipService.ToolTip="Kapat">
                        <FontIcon Glyph="&#xE711;" FontSize="16" Foreground="#FF4444"/>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- FOOTER Info (Optional) -->
            <TextBlock x:Name="ResolutionText" Text="" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="10,0,0,10" Foreground="#AAAAAA" FontSize="10"/>


            
        </Grid>
        
        <!-- Loading Indicator -->
        <ProgressRing x:Name="LoadingRing" IsActive="true" VerticalAlignment="Center" HorizontalAlignment="Center" Width="40" Height="40" />

    </Grid>
</UserControl>
