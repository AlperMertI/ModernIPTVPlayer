<UserControl
    x:Class="ModernIPTVPlayer.Controls.PosterCard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:ModernIPTVPlayer.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid x:Name="RootGrid" 
          Background="Transparent" 
          RenderTransformOrigin="0.5,0.5"
          Loaded="PosterCard_Loaded"
          Unloaded="PosterCard_Unloaded"
          PointerEntered="OnPointerEntered"
          PointerExited="OnPointerExited"
          PointerMoved="OnPointerMoved"
          Margin="4"> <!-- Reduced margin, let grid handle spacing -->

        <Grid.Resources>
            <Storyboard x:Name="HoverInStoryboard">
                <DoubleAnimation Storyboard.TargetName="ScaleTrans" Storyboard.TargetProperty="ScaleX" To="1.05" Duration="0:0:0.3">
                    <DoubleAnimation.EasingFunction>
                        <CubicEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
                <DoubleAnimation Storyboard.TargetName="ScaleTrans" Storyboard.TargetProperty="ScaleY" To="1.05" Duration="0:0:0.3">
                    <DoubleAnimation.EasingFunction>
                        <CubicEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
            </Storyboard>
            <Storyboard x:Name="HoverOutStoryboard">
                <DoubleAnimation Storyboard.TargetName="ScaleTrans" Storyboard.TargetProperty="ScaleX" To="1.0" Duration="0:0:0.3">
                    <DoubleAnimation.EasingFunction>
                        <CubicEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
                <DoubleAnimation Storyboard.TargetName="ScaleTrans" Storyboard.TargetProperty="ScaleY" To="1.0" Duration="0:0:0.3">
                    <DoubleAnimation.EasingFunction>
                        <CubicEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                </DoubleAnimation>
            </Storyboard>
        </Grid.Resources>

        <Grid.RenderTransform>
            <ScaleTransform x:Name="ScaleTrans" ScaleX="1.0" ScaleY="1.0"/>
        </Grid.RenderTransform>
        <Grid.Projection>
            <PlaneProjection x:Name="TiltProjection"/>
        </Grid.Projection>





        <!-- Main Content -->
        <Border x:Name="MainBorder" CornerRadius="12" Background="#FF1a1a1a">
            <Grid>
                <local:ShimmerCard x:Name="PosterShimmer" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                <Image x:Name="PosterImage" Stretch="UniformToFill" Opacity="0" ImageOpened="Image_ImageOpened"/>
                
                <!-- Title Overlay (Premium) -->
                <Grid VerticalAlignment="Bottom" 
                      Height="60" 
                      IsHitTestVisible="False"
                      Visibility="{x:Bind IsTitleVisible, Mode=OneWay}">
                    <Grid.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="Transparent" Offset="0"/>
                            <GradientStop Color="#99000000" Offset="1"/>
                        </LinearGradientBrush>
                    </Grid.Background>
                    <TextBlock Text="{x:Bind Title, Mode=OneWay}" 
                               Foreground="White" 
                               FontSize="12" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               TextTrimming="CharacterEllipsis"
                               Margin="8,0,8,0"/>
                </Grid>

                <!-- Progress Bar -->
                <ProgressBar VerticalAlignment="Bottom" Height="3" 
                             Value="{x:Bind ProgressValue, Mode=OneWay}" 
                             Maximum="100"
                             Foreground="{ThemeResource SystemAccentColor}"
                             Background="Transparent"
                             BorderThickness="0"
                             Visibility="{x:Bind ShowProgress, Mode=OneWay}"/>
                
                <!-- Status Badge (Top Right) -->
                <Border HorizontalAlignment="Right" VerticalAlignment="Top" 
                        Margin="8" CornerRadius="4" 
                        Padding="6,2"
                        Visibility="{x:Bind ShowBadge, Mode=OneWay}">
                    <Border.Background>
                        <AcrylicBrush TintColor="Black" TintOpacity="0.6" FallbackColor="Black"/>
                    </Border.Background>
                    <TextBlock Text="{x:Bind BadgeText, Mode=OneWay}" 
                               Foreground="White" FontSize="10" FontWeight="Bold"/>
                </Border>
            </Grid>
        </Border>


    </Grid>
</UserControl>
